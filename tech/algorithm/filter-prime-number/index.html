<!DOCTYPE html>
<html lang="zh-CN">
  <head><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:title" content="ç­›è´¨æ•°" />
    <title>ç­›è´¨æ•° | Cold World</title>
    <link rel="stylesheet" href="/css/style.css" /> 
    <link rel="stylesheet" href="/css/fonts.css" /> 
    <link rel="stylesheet" href="/css/syntax.css" />
    <link rel="stylesheet" href="/css/code.css" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

<script defer>
    document.addEventListener("DOMContentLoaded", function () {
      renderMathInElement(document.body, {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "$", right: "$", display: false }
        ]
      });
    });
  </script>
    
</head>

<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }
    </style>
</noscript>
  </head><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:title" content="ç­›è´¨æ•°" />
    <title>ç­›è´¨æ•° | Cold World</title>
    <link rel="stylesheet" href="/css/style.css" /> 
    <link rel="stylesheet" href="/css/fonts.css" /> 
    <link rel="stylesheet" href="/css/syntax.css" />
    <link rel="stylesheet" href="/css/code.css" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

<script defer>
    document.addEventListener("DOMContentLoaded", function () {
      renderMathInElement(document.body, {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "$", right: "$", display: false }
        ]
      });
    });
  </script>
    
</head>

<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }
    </style>
</noscript><body><div class="header">
  <nav class="nav">
    <div class="logo">
      <a href="http://www.coldcoding.top" accesskey="h" title="Cold World">
        <img src="https://images-1311785948.cos.ap-chengdu.myqcloud.com/typora/20240219225844.jpg" alt="logo" aria-label="logo">
        Cold World
      </a>
    </div>
    <nav class="menuPc">
      <ul class="menu wide">
        <a class="menu-item"
                href="/tech/" > Tech 
            </a><a class="menu-item"
                href="/life/" > Life 
            </a>
            <div class="dropdown pc">
                <a href="javascript:void(0);" 
                    class="menu-item menu-more dropbtn" title="" > Archive 
                </a>
                <div class="menu-more-content dropdown-content"><a href="/categories/" title="" > Categories 
                    </a><a href="/tags/" title="" > Tags 
                    </a></div>
            </div>
          <a class="menu-item"
                href="/weekly/" > Weekly 
            </a><a class="menu-item"
                href="/about/" > About 
            </a><a class="menu-item"
                href="/index.xml" > RSS 
            </a></ul>
    </nav>
    <a id="search-btn" href="javascript:void(0);">
      <span class="relative block icon">
        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
      </span>
    </a>
    <div id="fastSearch">
      <input id="searchInput" tabindex="0">
      <ul id="searchResults"></ul>
    </div>
    <div class="menuMobile">
      <button id="menu-button" onclick="toggleMenu()">
        <span class="relative block icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"></path></svg>
        </span>
      </button>
      <div class="menu-overlay" id="menuOverlay">
        <ul class="menu-items" id="menuItems">
          <li>
            <button onclick="closeMenu()">
              <span class="relative block icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"></path></svg>
              </span>
            </button>
          </li><li>
              <a class="menu-item"
                href="/tech/" > Tech 
            </a>
            </li><li>
              <a class="menu-item"
                href="/life/" > Life 
            </a>
            </li>
            <li>
              <div class="dropdown mobile">
                <a href="javascript:void(0);" class="menu-item menu-more dropbtn" title="" > Archive 
                </a>
                <div class="menu-more-content dropdown-content"><a href="/categories/" title="" > Categories </a><a href="/tags/" title="" > Tags </a></div>
              </div>
            </li>
          <li>
              <a class="menu-item"
                href="/weekly/" > Weekly 
            </a>
            </li><li>
              <a class="menu-item"
                href="/about/" > About 
            </a>
            </li><li>
              <a class="menu-item"
                href="/index.xml" > RSS 
            </a>
            </li></ul>
      </div>
    </div>
  </nav>
</div>

<script>
  let documentTop = 0; 
  const body = document.body;

  function toggleMenu() {
    var menuOverlay = document.getElementById("menuOverlay");
    menuOverlay.classList.toggle("show");
    if (menuOverlay.classList.contains("show")) {
      
      var menuButton = document.getElementById("menu-button");
      menuButton.style.display = "none";
      
      documentTop = document.scrollingElement.scrollTop;
      body.style.position = "fixed"
      body.style.top = -documentTop + "px";
    }
  }

  document.addEventListener("click", function(event) {
    if (menuOverlay.classList.contains("show")) {
      console.log(event.target)
      if (event.target.classList.contains("show")) {
        closeMenu(); 
      }
    }
  });
  
  function closeMenu() {
    var menuOverlay = document.getElementById("menuOverlay");
    menuOverlay.classList.remove("show");
    var menuButton = document.getElementById("menu-button");
    menuButton.style.display = "inline-block";
    
    body.style.position = "static";
    body.style.top = "auto";
    document.scrollingElement.scrollTop = documentTop;
  }
</script>

<script src="/js/fuse.min.js"></script>
<script src="/js/fastsearch.js"></script><div class="main page">
<article class="post-single">
  <div id="single-content">
    <header class="post-header">
      <div class="breadcrumbs"><div  class="breadcrumb">
    
    


    <a href="http://coldcoding.top/">ğŸ  Home</a>&nbsp;Â»&nbsp;<a href="http://coldcoding.top/tech/">ğŸ“‘Tech</a>&nbsp;Â»&nbsp;<a href="http://coldcoding.top/tech/algorithm/">ğŸ§®Algorithm</a></div></div>
      <h1 class="post-title">ç­›è´¨æ•°</h1>
      <div class="post-meta"><span class="parent-post-meta">
    <span id="post_meta_style_initpost" class="post_meta_style">Published at:</span>2023/01/01&nbsp;&nbsp;&nbsp;
    
    <span id="post_meta_style_pagepv" class="post_meta_style">PagePV:</span><span id="twikoo_visitors">0</span>&nbsp;&nbsp;&nbsp;
    
    
</span></div>
    </header>
      

<aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details >
            <summary accesskey="c" title="(Alt + C)">
                
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e8%b4%a8%e6%95%b0" aria-label="è´¨æ•°">è´¨æ•°</a></li>
                    <li>
                        <a href="#%e5%ae%8c%e5%85%a8%e5%b9%b3%e6%96%b9%e6%95%b0" aria-label="å®Œå…¨å¹³æ–¹æ•°">å®Œå…¨å¹³æ–¹æ•°</a></li>
                    <li>
                        <a href="#%e5%a4%9a%e9%87%8d%e9%9b%86%e5%90%88%e7%9a%84%e6%8e%92%e5%88%97%e6%95%b0%e9%97%ae%e9%a2%98" aria-label="å¤šé‡é›†åˆçš„æ’åˆ—æ•°é—®é¢˜">å¤šé‡é›†åˆçš„æ’åˆ—æ•°é—®é¢˜</a></li>
                    <li>
                        <a href="#%e7%ba%a6%e6%95%b0" aria-label="çº¦æ•°">çº¦æ•°</a><ul>
                            
                    <li>
                        <a href="#%e7%ba%a6%e6%95%b0%e7%9a%84%e4%b8%aa%e6%95%b0" aria-label="çº¦æ•°çš„ä¸ªæ•°">çº¦æ•°çš„ä¸ªæ•°</a></li>
                    <li>
                        <a href="#%e7%ba%a6%e6%95%b0%e7%9a%84%e5%92%8c" aria-label="çº¦æ•°çš„å’Œ">çº¦æ•°çš„å’Œ</a></li>
                    <li>
                        <a href="#code" aria-label="Code">Code</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        if (elements) {
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                    (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                    return element;
                }
            }) || activeElement

            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                if (element === activeElement){
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
                } else {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
                }
            })
        }
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
    <div class="post-content"><h2 id="è´¨æ•°">è´¨æ•°</h2>
<ol>
<li>
<p>è´¨æ•°å’Œåˆæ•°æ˜¯é’ˆå¯¹æ‰€æœ‰å¤§äº $1$ çš„ã€Œè‡ªç„¶æ•°ã€æ¥å®šä¹‰çš„ï¼ˆæ‰€æœ‰å°äºç­‰äº $1$ çš„æ•°éƒ½ä¸æ˜¯è´¨æ•°ï¼‰ã€‚</p>
</li>
<li>
<p>æ‰€æœ‰å°äºç­‰äº $1$ çš„æ•´æ•°æ—¢ä¸æ˜¯è´¨æ•°ä¹Ÿä¸æ˜¯åˆæ•°ã€‚</p>
</li>
<li>
<p>è´¨æ•°çš„åˆ¤å®šâ€”â€”è¯•é™¤æ³•ï¼š</p>
<p>$d | n$ ä»£è¡¨çš„å«ä¹‰æ˜¯ $d$ èƒ½æ•´é™¤ $n$ã€‚ï¼ˆè¿™é‡Œçš„ <code>|</code> ä»£è¡¨æ•´é™¤ï¼‰</p>
<p>ä¸€ä¸ªåˆæ•°çš„çº¦æ•°æ€»æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå¦‚æœ $d|n$ï¼Œé‚£ä¹ˆ $(n/d)|n$ï¼Œå› æ­¤æˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºè´¨æ•°çš„æ—¶å€™ï¼Œåªéœ€è¦åˆ¤æ–­è¾ƒå°çš„é‚£ä¸€ä¸ªæ•°èƒ½å¦æ•´é™¤ $n$ å°±è¡Œäº†ï¼Œå³åªéœ€æšä¸¾ $d\le(n\div d)$ï¼Œå³ $d\times d\le n$ï¼Œ$d\le \sqrt{n}$ å°±è¡Œäº†ã€‚</p>
<p><code>sqrt(n)</code> è¿™ä¸ªå‡½æ•°æ‰§è¡Œçš„æ—¶å€™<strong>æ¯”è¾ƒæ…¢</strong>ã€‚</p>
<p>$i * i &lt;= n$ åˆå®¹æ˜“<strong>æº¢å‡º</strong>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln">1</span><span class="cl"><span class="kt">bool</span> <span class="nf">is_prime</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="c1">// x / i æ˜¯æœ€å¿«ä¸”æœ€ä¸å®¹æ˜“çˆ†ç‚¸çš„å†™æ³•
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>åˆ†è§£è´¨å› æ•°â€”â€”è¯•é™¤æ³•ï¼ˆç®—æ•°åŸºæœ¬å®šç†ï¼‰</p>
<p>ç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•ä¸€ä¸ªå¤§äº $1$ çš„è‡ªç„¶æ•° $n$ï¼Œå¦‚æœ $n$ ä¸ä¸ºè´¨æ•°ï¼Œé‚£ä¹ˆ $n$ å¯ä»¥å”¯ä¸€åˆ†è§£æˆæœ‰é™ä¸ªè´¨æ•°çš„ä¹˜ç§¯ $n=P_1^{a1}P^{a2}_2P^{a3}_3\dots P^{an}_n$ï¼Œè¿™é‡Œ $P_1&lt;P_2&lt;P_3&lt;\dots &lt;P_n$ å‡ä¸ºè´¨æ•°ï¼Œå…¶ä¸­æŒ‡æ•° $ai$ æ˜¯æ­£æ•´æ•°ã€‚</p>
<p>ç‰¹åˆ«è¦æ³¨æ„â€”â€”åˆ†è§£è´¨å› æ•°ä¸è´¨å› æ•°ä¸ä¸€æ ·ï¼Œåˆ†è§£è´¨å› æ•°æ˜¯ä¸€ä¸ªè¿‡ç¨‹ï¼Œè€Œè´¨å› æ•°æ˜¯ä¸€ä¸ªæ•°ã€‚</p>
<p><strong>ä¸€ä¸ªåˆæ•°åˆ†è§£è€Œæˆçš„è´¨å› æ•°æœ€å¤šåªåŒ…å«ä¸€ä¸ªå¤§äº $\sqrt{n}$ çš„è´¨å› æ•°ã€‚</strong>ï¼ˆåè¯æ³•ï¼Œè‹¥ $n$ å¯ä»¥è¢«åˆ†è§£æˆä¸¤ä¸ªå¤§äº $\sqrt{n}$ çš„è´¨å› æ•°ï¼Œåˆ™è¿™ä¸¤ä¸ªè´¨å› æ•°ç›¸ä¹˜çš„ç»“æœå¤§äº $n$ï¼Œä¸äº‹å®çŸ›ç›¾ï¼‰</p>
<p>å½“æšä¸¾åˆ°æŸä¸€ä¸ªæ•° $i$ çš„æ—¶å€™ï¼Œ$n$ çš„å› å­é‡Œé¢å·²ç»ä¸åŒ…å« $[2,iâˆ’1]$ é‡Œé¢çš„æ•°ï¼ˆå·²ç»è¢«é™¤å¹²å‡€äº†ï¼‰ï¼Œå¦‚æœ $n | i$ï¼Œåˆ™ $i$ çš„å› å­é‡Œé¢ä¹Ÿå·²ç»ä¸åŒ…å« $[2,iâˆ’1]$ é‡Œé¢çš„æ•°ï¼Œå› æ­¤æ¯æ¬¡æšä¸¾çš„æ•°éƒ½æ˜¯è´¨æ•°ã€‚</p>
<p>è´¨å› å­ï¼ˆè´¨å› æ•°ï¼‰åœ¨æ•°è®ºé‡Œæ˜¯æŒ‡èƒ½æ•´é™¤ç»™å®šæ­£æ•´æ•°çš„è´¨æ•°ã€‚æ ¹æ®ç®—æœ¯åŸºæœ¬å®šç†ï¼Œä¸è€ƒè™‘æ’åˆ—é¡ºåºçš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæ­£æ•´æ•°éƒ½èƒ½å¤Ÿä»¥å”¯ä¸€çš„æ–¹å¼è¡¨ç¤ºæˆå®ƒçš„è´¨å› æ•°çš„ä¹˜ç§¯ã€‚</p>
<p>ä¸¤ä¸ªæ²¡æœ‰å…±åŒè´¨å› å­çš„æ­£æ•´æ•°ç§°ä¸ºäº’è´¨ã€‚å› ä¸º $1$ æ²¡æœ‰è´¨å› å­ï¼Œ$1$ ä¸ä»»ä½•æ­£æ•´æ•°ï¼ˆåŒ…æ‹¬ $1$ æœ¬èº«ï¼‰éƒ½æ˜¯äº’è´¨ã€‚</p>
<p>åªæœ‰ä¸€ä¸ªè´¨å› å­çš„æ­£æ•´æ•°ä¸ºè´¨æ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kt">void</span> <span class="nf">divide</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">            <span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">            <span class="k">while</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">x</span> <span class="o">/=</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="c1">// å¤§äºsqrt(n)çš„æ•°
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1"></span>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>ç­›è´¨æ•°ï¼ˆæœ´ç´ ç­›æ³•ï¼‰</p>
<p>æ­¥éª¤ï¼šæŠŠ $[2,nâˆ’1]$ ä¸­çš„æ‰€æœ‰çš„æ•°çš„å€æ•°éƒ½æ ‡è®°ä¸Šï¼Œæœ€åæ²¡æœ‰è¢«æ ‡è®°çš„æ•°å°±æ˜¯è´¨æ•°ã€‚</p>
<p>åŸç†ï¼šå‡å®šæœ‰ä¸€ä¸ªæ•° $p$ æœªè¢« $[2,pâˆ’1]$ ä¸­çš„æ•°æ ‡è®°è¿‡ï¼Œé‚£ä¹ˆè¯´æ˜ï¼Œä¸å­˜åœ¨ $[2,pâˆ’1]$ ä¸­çš„ä»»ä½•ä¸€ä¸ªæ•°çš„å€æ•°æ˜¯ $p$ï¼Œä¹Ÿå°±æ˜¯è¯´ $[2,pâˆ’1]$ ä¸­ä¸å­˜åœ¨ $p$ çš„çº¦æ•°ï¼Œå› æ­¤ï¼Œæ ¹æ®è´¨æ•°çš„å®šä¹‰å¯çŸ¥ï¼š$p$ æ˜¯è´¨æ•°ã€‚</p>
<p>è°ƒå’Œçº§æ•°ï¼šå½“ $n$ è¶‹è¿‘äºæ­£æ— ç©·çš„æ—¶å€™ï¼Œ$\frac{1}{2}+\frac{1}{3}+\frac{1}{4}+\frac{1}{5}+\dots+\frac{1}{n}=\ln n+c$ï¼ˆ$c$ æ˜¯æ¬§æ‹‰å¸¸æ•°ï¼Œçº¦ç­‰äº $0.577$ å·¦å³ï¼‰</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šçº¦ä¸º $O(n\log n)$ï¼ˆæ³¨ï¼šæ­¤å¤„çš„ $\log$ ç‰¹æŒ‡ä»¥ $2$ ä¸ºåº•ï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">;</span> <span class="c1">// primes[] å­˜å‚¨æ‰€æœ‰ç´ æ•°
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>         <span class="c1">// st[x] å­˜å‚¨ x æ˜¯å¦è¢«ç­›æ‰
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kt">void</span> <span class="nf">get_primes</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">primes</span><span class="p">[</span><span class="n">cnt</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="n">i</span><span class="p">)</span> <span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> <span class="c1">// ç­›æ‰ i çš„å€æ•°
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>åŸƒæ°ç­›ï¼ˆç¨åŠ ä¼˜åŒ–ç‰ˆçš„ç­›æ³•ï¼‰</p>
<p>è´¨æ•°å®šç†ï¼š$1\sim n$ ä¸­æœ‰ $n/ln\ n$ä¸ªè´¨æ•°ã€‚</p>
<p>æ­¥éª¤ï¼šåœ¨æœ´ç´ ç­›æ³•çš„è¿‡ç¨‹ä¸­åªç”¨è´¨æ•°é¡¹å»ç­›ã€‚åŸç†å…¶å®å¾ˆç®€å•ï¼Œæ‰€æœ‰çš„åˆæ•°éƒ½å¯ä»¥ç”¨è´¨å› æ•°çš„ä¹˜ç§¯æ¥è¡¨ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç­›æ‰è´¨æ•°çš„å€æ•°ï¼Œåˆæ•°è‡ªç„¶ä¹Ÿå°±è¢«ç­›æ‰äº†ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼š$O(n\log(\log n))$ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">;</span> <span class="c1">// primes[] å­˜å‚¨æ‰€æœ‰ç´ æ•°
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// st[x] å­˜å‚¨ x æ˜¯å¦è¢«ç­›æ‰
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kt">void</span> <span class="nf">get_primes</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1">// æ²¡æœ‰è¢«ç­›æ‰ï¼Œä¹Ÿå°±æ˜¯è´¨æ•°ï¼ŒæŠŠè´¨æ•°çš„å€æ•°ç­›æ‰ï¼Œè€Œä¸å»è€ƒè™‘åˆæ•°çš„å€æ•°
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">			<span class="n">primes</span><span class="p">[</span><span class="n">cnt</span> <span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="n">i</span><span class="p">)</span> <span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>çº¿æ€§ç­›</p>
<p>è‹¥ $n\approx10^6$ï¼Œçº¿æ€§ç­›å’ŒåŸƒæ°ç­›çš„æ—¶é—´æ•ˆç‡å·®ä¸å¤šï¼Œè‹¥ $n\approx10^7$ï¼Œçº¿æ€§ç­›ä¼šæ¯”åŸƒæ°ç­›å¿«äº†å¤§æ¦‚ä¸€å€ã€‚</p>
<p>åŸƒæ°ç­›æ³•å°½ç®¡åˆ©ç”¨äº†è´¨æ•°çš„å€æ•°ä¸€å®šä¸æ˜¯è´¨æ•°æ¥æ„é€ ç­›å­ï¼Œä½†è¿˜æ˜¯æœ‰é‡å¤è®¡ç®—ï¼Œå¦‚ $30$ ä¸æ˜¯è´¨æ•°ï¼Œåœ¨ $i = 2$æ—¶å€™ï¼Œ$2 * 15$ è¢«ç­›æ‰äº†ä¸€æ¬¡ï¼Œåœ¨ $i = 5$ æ—¶å€™ï¼Œ$5 * 6$åˆè¢«ç­›æ‰äº†ä¸€æ¬¡ï¼Œé€ æˆæ•ˆç‡çš„æµªè´¹ã€‚</p>
<p>æˆ‘ä»¬åœ¨æšä¸¾å€æ•°æ—¶ï¼Œä¿è¯å½“å‰è´¨æ•°ä¸èƒ½æ•´é™¤è¿™ä¸ªå€æ•°å°±å¥½äº†ï¼Œå½“ç„¶äº†ï¼Œåœ¨ä¹‹å‰è¦å…ˆç­›ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯ p æ˜¯ m çš„ pï¼Œè¿™æ ·æˆ‘ä»¬åœ¨æœ€ä¼˜æ€§çš„æ¡ä»¶ä¸‹ï¼Œå¯¹æ¯ä¸€ä¸ªè´¨æ•°ï¼Œå®ƒæ‰€æœ‰å¯¹åº”çš„å€æ•°ï¼Œéƒ½è¢«æšä¸¾åˆ°ï¼Œä¹Ÿå°±ä¿è¯äº†å¯è¡Œæ€§ã€‚</p>
<p>æ ¸å¿ƒæ€æƒ³ï¼š<strong>æ‰€æœ‰çš„åˆæ•°å¯ä»¥è¡¨ç¤ºä¸ºä¸¤ä¸ªæˆ–å¤šä¸ªè´¨æ•°çš„ç§¯ã€‚</strong></p>
<p>æ ¸å¿ƒï¼š<strong>$1\sim n$ å†…çš„åˆæ•° $p$ åªä¼šè¢«å…¶æœ€å°è´¨å› å­ç­›æ‰ã€‚</strong>ï¼ˆç®—æ•°åŸºæœ¬å®šç†ï¼‰</p>
<p>åŸç†ï¼š$1\sim n$ ä¹‹å†…çš„ä»»ä½•ä¸€ä¸ªåˆæ•°ä¸€å®šä¼šè¢«ç­›æ‰ï¼Œè€Œä¸”ç­›çš„æ—¶å€™åªç”¨æœ€å°è´¨å› å­æ¥ç­›ï¼Œç„¶åæ¯ä¸€ä¸ªæ•°éƒ½åªæœ‰ä¸€ä¸ªæœ€å°è´¨å› å­ï¼Œå› æ­¤æ¯ä¸ªæ•°éƒ½åªä¼šè¢«ç­›ä¸€æ¬¡ï¼Œå› æ­¤çº¿æ€§ç­›æ³•æ˜¯çº¿æ€§çš„ã€‚</p>
<p>æšä¸¾åˆ° $i$ çš„æœ€å°è´¨å› å­çš„æ—¶å€™å°±ä¼šåœä¸‹æ¥ï¼Œå³ <code>if(i % primes[j] == 0) break;</code></p>
<p>å½“ <code>i % primes[j] != 0</code> æ—¶ï¼Œ<code>primes[j]</code> ä¸€å®šå°äº $i$ çš„æœ€å°è´¨å› å­ï¼Œ<code>primes[j]</code> ä¸€å®šæ˜¯ <code>primes[j]*i</code> çš„æœ€å°è´¨å› å­ã€‚
å½“ <code>i % primes[j] == 0</code> æ—¶ï¼Œ<code>primes[j]</code> ä¸€å®šæ˜¯ $i$ çš„æœ€å°è´¨å› å­ï¼Œè€Œ <code>primes[j]</code> åˆæ˜¯ <code>primes[j]</code> çš„æœ€å°è´¨å› å­ï¼Œå› æ­¤ <code>primes[j]</code> æ˜¯ <code>primes[j]*i</code> çš„æœ€å°è´¨å› å­ã€‚</p>
<p>é‡Œé¢å…³é”®å°±æ˜¯é‚£ä¸ª $break$ï¼Œå¦‚æœä¸ $break$ï¼Œå°±æ˜¯å†å¾€å¤§é‡Œæšä¸¾ï¼Œé‚£ä¹ˆä»¥åæšä¸¾åˆ°çš„è´¨æ•°ï¼Œä¸€å®šä¸æ˜¯æœ€å°è´¨æ•°ï¼Œå› ä¸ºå®ƒéƒ½æ¯”å½“å‰è´¨æ•°å¤§äº†ï¼Œæ€ä¹ˆå¯èƒ½æœ€å°ï¼Œæœ€å°ä¹Ÿåªå¯èƒ½æ˜¯å½“å‰çš„è´¨æ•°ï¼Œä»è€Œå®ç°äº†ä¼˜åŒ–ã€‚</p>
<p>$a$ $\times$ $prime[x]\leqslant n$</p>
</li>
</ol>
<p>â€‹ <a href="http://t.zoukankan.com/cyanigence-oi-p-11716066.html">http://t.zoukankan.com/cyanigence-oi-p-11716066.html</a></p>
<p><strong>ä¸€ä¸ªæ€§è´¨ï¼šä»»ä½•ä¸€ä¸ªåˆæ•° $n$ å¿…å®šåŒ…å«ä¸€ä¸ªä¸è¶…è¿‡($\sqrt{n}$)çš„è´¨å› å­ã€‚ï¼ˆå¾…è¯ï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">;</span> <span class="c1">// primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kt">void</span> <span class="nf">get_primes</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">primes</span><span class="p">[</span><span class="n">cnt</span> <span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="c1">// j &lt; cnt ä¸å¿…è¦ï¼Œå› ä¸º primes[cnt - 1] = å½“å‰æœ€å¤§è´¨æ•°
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"></span>        <span class="c1">// å¦‚æœ i ä¸æ˜¯è´¨æ•°ï¼Œè‚¯å®šä¼šåœ¨ä¸­é—´å°± break æ‰
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1"></span>        <span class="c1">// å¦‚æœ i æ˜¯è´¨æ•°ï¼Œé‚£ä¹ˆ primes[cnt - 1] = iï¼Œä¹Ÿä¿è¯äº† j &lt; cnt
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1"></span>        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">            <span class="c1">//å¦‚æœiæ˜¯å‰é¢æŸä¸ªè´¨æ•°çš„å€æ•°æ—¶, è¯´æ˜iä»¥åä¼šç”±æŸä¸ªæ›´å¤§çš„æ•°ä¹˜è¿™ä¸ªå°è´¨æ•°ç­›å»
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="c1"></span>            <span class="c1">//åŒç†, ä¹‹åçš„è´¨æ•°ä¹Ÿæ˜¯æ²¡æœ‰å¿…è¦çš„, å› æ­¤åœ¨è¿™ä¸ªæ—¶å€™, å°±å¯ä»¥è·³å‡ºå¾ªç¯äº†
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="å®Œå…¨å¹³æ–¹æ•°">å®Œå…¨å¹³æ–¹æ•°</h2>
<ol>
<li>ä¸€ä¸ªæ•´æ•° $a$ æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œæ˜¯æŒ‡å®ƒæ˜¯æŸä¸€ä¸ªæ•´æ•°çš„å¹³æ–¹ï¼Œå³å­˜åœ¨ä¸€ä¸ªæ•´æ•° $b$ ï¼Œä½¿å¾— $a=b^2$</li>
<li>ä¸€ä¸ªæ­£æ•´æ•°å¦‚æœæ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œé‚£ä¹ˆå®ƒçš„è´¨å› æ•°ä¸€å®šå…¨éƒ¨éƒ½æ˜¯æ˜¯å¶æ•°æ¬¡ã€‚
ä¾‹å¦‚ $36 = 2^2 * 3^2$ $ 900 = 2^2 _ 3^2 _ 5^2$</li>
<li>ä¸€ä¸ªéå®Œå…¨å¹³æ–¹æ•°åˆ™è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯å¥‡æ•°æ¬¡çš„è´¨å› æ•°ã€‚
ä¾‹å¦‚ $18 = 2^1 * 3^2$
è‹¥ä½¿ $18$ å˜ä¸ºå®Œå…¨å¹³æ–¹æ•°ï¼Œå°±è¦ä½¿å¾—å¥‡æ•°æ¬¡å˜ä¸ºå¶æ•°æ¬¡ï¼Œè¿™é‡Œå°±å¯ä»¥ä¹˜ä»¥ä¸€ä¸ª $2$ ä½¿å¾— $2^1$ å˜ä¸º $2^2$ï¼Œæœ€åå¾—åˆ°çš„ $18 * 2 = 36$ å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å®Œå…¨å¹³æ–¹æ•°ã€‚</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// ç»™å®šä¸€ä¸ªæ­£æ•´æ•° nï¼Œè¯·æ‰¾åˆ°æœ€å°çš„æ­£æ•´æ•° xï¼Œä½¿å¾—å®ƒä»¬çš„ä¹˜ç§¯æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ã€‚
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1">// æˆ‘ä»¬å…ˆç­›æ‰æ‰€æœ‰çš„å¶æ•°æ¬¡çš„è´¨å› æ•°ï¼Œç„¶åå‰©ä¸‹çš„å°±æ˜¯å¥‡æ•°æ¬¡çš„è´¨å› æ•°ï¼Œæˆ–è€…æ˜¯ 1 ï¼Œå°±æ˜¯æˆ‘ä»¬è¦çš„ç»“æœ
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">LL</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">LL</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%lld&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="n">LL</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">/</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    	<span class="k">while</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">n</span> <span class="o">/=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%lld&#34;</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="å¤šé‡é›†åˆçš„æ’åˆ—æ•°é—®é¢˜">å¤šé‡é›†åˆçš„æ’åˆ—æ•°é—®é¢˜</h2>
<p>æ’åˆ—æ•°å…¬å¼ï¼š</p>
<p>$$
\frac{(\alpha1+\alpha2+&hellip;+\alpha k)!}{\alpha_1!\cdot\alpha_2!\cdot&hellip;\cdot\alpha_k!}
$$</p>
<h2 id="çº¦æ•°">çº¦æ•°</h2>
<blockquote>
<p>ç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•ä¸€ä¸ªå¤§äº $1$ çš„è‡ªç„¶æ•° $n$ï¼Œå¦‚æœ $n$ ä¸ä¸ºè´¨æ•°ï¼Œé‚£ä¹ˆ $n$ å¯ä»¥å”¯ä¸€åˆ†è§£æˆæœ‰é™ä¸ªè´¨æ•°çš„ä¹˜ç§¯ $n=P_1^{\alpha_1}P^{\alpha_2}_2P^{\alpha_3}_3\dots P^{\alpha_n}_n$ï¼Œè¿™é‡Œ $P_1&lt;P_2&lt;P_3&lt;\dots &lt;P_n$ å‡ä¸ºè´¨æ•°ï¼Œå…¶ä¸­æŒ‡æ•° $\alpha_i$ æ˜¯æ­£æ•´æ•°ã€‚</p>
</blockquote>
<p>egï¼š</p>
<ol>
<li>$12(1, 2, 3, 4, 6, 12)$</li>
<li>$12 = 2^2\times3^1$</li>
</ol>
<h3 id="çº¦æ•°çš„ä¸ªæ•°">çº¦æ•°çš„ä¸ªæ•°</h3>
<blockquote>
<p>$cnt = (\alpha_1 + 1)\times(\alpha_2 + 1)\dots (\alpha_k + 1)$</p>
</blockquote>
<p>$eg:$</p>
<p>â€‹ $cnt = (2 + 1) \times (1 + 1) = 3 \times 2  = 6$</p>
<h3 id="çº¦æ•°çš„å’Œ">çº¦æ•°çš„å’Œ</h3>
<blockquote>
<p>$sum = (P_1^0 + P_1^1 + P_1^2 +\dots + P_1^{\alpha_1})\times(P_2^0 + P_2^1 + P_2^2 +\dots + P_2^{\alpha_2})\times\dots(P_k^0 + P_k^1 + P_k^2 +\dots + P_k^{\alpha_k})$</p>
</blockquote>
<p>$eg:$</p>
<p>â€‹ $sum = (1 + 2^1 + 2^2) \times (1 + 3^1) = 7 \times 4 = 28$</p>
<p>â€‹ å…¶å®ä¹Ÿå°±æ˜¯æ’åˆ—ç»„åˆï¼Œ2 å¯ä»¥å– 0 æ¬¡ï¼Œ1 æ¬¡ï¼Œ2 æ¬¡ï¼Œ3 å¯ä»¥å– 0 æ¬¡ï¼Œ1 æ¬¡ã€‚</p>
<p>$$
é—®é¢˜:\ ç»™å®šä¸€ä¸ªæ•°\ 1\ â‰¤\ sum\ â‰¤\ 2\times10^9,\ æ‰¾å‡ºæ‰€æœ‰çº¦æ•°å’Œç­‰äº\ sum\ çš„æ•°ã€‚
$$</p>
<p>åˆ†æï¼š</p>
<p>â€‹ é—®é¢˜å°±æ˜¯æ‰¾åˆ°æŸä¸ªæ•°ï¼Œä½¿å¾—å®ƒçš„çº¦æ•°ä¹‹å’Œä¸º $sum$</p>
<ol>
<li>
<p>å¯ä»¥é¦–å…ˆç²—ç•¥çš„ä¼°è®¡ä¸€ä¸‹æœ‰å¤šå°‘ä¸ªå½¢å¦‚ $(P_1^0 + P_1^1 + P_1^2 +\dots + P_1^{\alpha_1})$ çš„é¡¹
$(1 + 2)\times(1 + 3)\times(1 + 5) \times(1 + 7)\times(1 + 11)\times(1 + 13)\times(1 + 17)\times(1 + 19)\times(1+21)\times(1+23)$
$= 3\times4\times6\times8\times12\times14\times18\times20\times22\times24$
$= 18\times10^9$
$&gt;\ 2\ \times10^9$
æ‰€ä»¥å¤§æ¦‚ä¸ä¼šè¶…è¿‡ 10 é¡¹ï¼Œé‚£ä¹ˆè¿™é“é¢˜å¯ä»¥ç”¨ dfs æ¥çˆ†æœæ¯ä¸€ä¸ª $P_i$ å’Œ $\alpha_i$ï¼Œé€’å½’æ·±åº¦ä¸è¶…è¿‡ 10 å±‚ã€‚ä½†æ˜¯éœ€è¦å‰ªæï¼Œä¸ç„¶æ¯ä¸€å±‚éƒ½ä» 2 å¼€å§‹æšä¸¾ï¼Œæ—¶é—´å¤æ‚åº¦ä»ç„¶æ˜¯å¾ˆé«˜çš„ã€‚</p>
</li>
<li>
<p>$sum$ ä¸€èˆ¬æƒ…å†µä¸‹åªæœ‰ä¸¤ç§æƒ…å†µï¼š</p>
<ol>
<li>
<p>$sum = (1 + P_1)(1 + P_2 +\dots)\dots$</p>
<p>å¦‚æœ$(P_1 &gt; =\sqrt {sum})$ ï¼Œ é‚£ä¹ˆä¸€å®šæœ‰ $(1 + P_1)(1 + P_2) &gt; (1 + P_1)^2 &gt; P_1^2&gt;=sum$
æ‰€ä»¥ $P_1 &lt;= \sqrt{sum}$</p>
</li>
<li>
<p>$sum = (1 + P_1 + P_1^2 + \dots)(1 + \dots) &gt; P_1^2$
å¦‚æœ $P_1 &gt; =\sqrt {sum}$ ï¼Œé‚£ä¹ˆä¸€å®šæœ‰ $1 + P_1 + P_1^2 &gt; P_1^2 &gt;= sum$
æ‰€ä»¥ $P_1 &lt;= \sqrt{sum}$</p>
</li>
</ol>
<blockquote>
<p>ç‰¹åˆ¤ï¼š<strong>å¦‚æœæœ‰ $P_1 &gt; =\sqrt {sum}$ï¼Œé‚£ä¹ˆä¸€å®šæœ‰ $sum = 1 + P_1$</strong></p>
<p>è‹¥å­˜åœ¨ $P_i &gt;= \sqrt {sum},\ P_j&gt;= \sqrt {sum}$ï¼Œä¸” $P_i &lt; P_j$ï¼Œ</p>
<p>é‚£ä¹ˆæ ¹æ®ä¸Šé¢çš„ç»“è®ºä¸€å®šæœ‰ $sum = 1 + P_i,\ sum = 1 + P_j$ï¼Œå¾—åˆ°$P_i = P_j$ï¼Œä¸æ¡ä»¶ç›¸æ‚–</p>
<p>æ‰€ä»¥å¦‚æœå­˜åœ¨ä¸€ä¸ª $P_1 â‰¥ \sqrt{sum} \ ä¸”æ»¡è¶³\ s = 1 + P_1$ï¼Œé‚£ä¹ˆæœ‰ä¸”ä»…æœ‰ $P1$ è¿™ä¸€ä¸ªã€‚</p>
<p>å½“ $\alpha_1 = 1$ æ—¶å€™ï¼Œä¸” $sum = 1 + P_1$ ï¼Œé‚£ä¹ˆåªéœ€è¦åˆ¤æ–­ $sum - 1$ æ˜¯ä¸æ˜¯è´¨æ•°å³å¯ã€‚
æ¯”å¦‚ $s = 12$ï¼Œ$s - 1 = 11$ï¼Œå¦‚æœ $s - 1$ æ˜¯è´¨æ•°ï¼Œé‚£ä¹ˆåªæœ‰ $1$ å’Œæœ¬èº«ï¼Œç›¸åŠ ä¸€å®šç­‰äº $s$ ï¼Œåè¿‡æ¥ä¸€æ ·çš„ï¼Œå¦‚æœ $s - 1$ æ˜¯è´¨æ•°ï¼Œé‚£ä¹ˆåªæœ‰ $1$ å’Œ $s - 1$ ä¸¤ä¸ªçº¦æ•°ï¼Œç›¸åŠ åä¸€å®šä¸º $s$ ã€‚</p>
</blockquote>
<p>å…¶å®å¯¹äºæ¯ä¸€å±‚çš„ $sum$ï¼Œæˆ‘ä»¬éƒ½æ˜¯æœç´¢ $P_1$ï¼Œç„¶åç”¨ $sum$ æ¥é™¤ä»¥è¯¥é¡¹ï¼Œå¾—åˆ°ï¼š</p>
<p>$$
\frac {sum}{1 + P_1^1 +\dots+P_1^{\alpha_1}}
$$</p>
<p>æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯èƒ½ä¸èƒ½æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ $(1 + P_1 + P_1^2 + \dots + P_1^{\alpha_1})$ èƒ½å¤Ÿä½¿å¾—</p>
<p>$$
sum %(1 + P_1 + P_1^2 + \dots + P_1^{\alpha_1}) == 0
$$</p>
<p>æœ‰çš„è¯ï¼Œæˆ‘ä»¬å°± $sum /= (1 + P_1 + P_1^2 + \dots + P_k^{\alpha_1})$ å† <strong>dfs</strong> åˆ°ä¸‹ä¸€å±‚ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">for</span><span class="p">(</span><span class="nl">primes</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,...)</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="err">Î±</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,...)</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">sum</span> <span class="n">mod</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">p1</span><span class="o">+</span><span class="n">p1</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">...</span><span class="o">+</span><span class="n">p1</span><span class="o">^</span><span class="err">Î±</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">            <span class="n">dfs</span><span class="p">(</span><span class="err">ä¸‹ä¸€å±‚</span><span class="p">)</span>
</span></span></code></pre></div></li>
<li>
<p><code>dfs(int last, int prod, int s)</code>çš„ä¸‰ä¸ªå‚æ•°</p>
<ol>
<li><code>last</code>
è¡¨ç¤ºä¸Šä¸€ä¸ªæšä¸¾çš„è´¨æ•°ï¼Œé¿å…é‡å¤ï¼Œä¾‹å¦‚ï¼Œæšä¸¾ 2 ä¹‹åå† dfs åˆ°ä¸‹ä¸€å±‚ï¼Œå°±åº”è¯¥ä» 3 å¼€å§‹ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹æšä¸¾ã€‚</li>
<li><code>prod</code>
è¡¨ç¤º $sum = (P_1^0 + P_1^1 +\dots + P_1^{\alpha_1})\times(P_2^0 + P_2^1 +\dots + P_2^{\alpha_2})\times\dots(P_k^0 + P_k^1+\dots + P_k^{\alpha_k})$ å½“å‰è¿›è¡Œåˆ°å“ªä¸€ä¸ªæ‹¬å·é‡Œé¢çš„æœ€é«˜æ¬¡é¡¹ $P_i^{\alpha_i}$ çš„ä¹˜ç§¯å’Œï¼Œä¾‹å¦‚ $sum = (1 + 2 + 2^2)\times(1 + 3 + 3^3)(1 + \dots)$ï¼Œé‚£ä¹ˆ $dfs$ åˆ°ç¬¬ä¸‰å±‚çš„æ—¶å€™ï¼Œ$prod = 2^2 \times 3^3$
ç”±ç®—æœ¯åŸºæœ¬å®šç†å¯çŸ¥ï¼Œä¸€ä¸ªæ•° $N = P_1^{\alpha_1}\times P_2^{\alpha_2}\times\dots\times P_k^{\alpha_k}$ï¼Œ
æˆ‘ä»¬æ±‚å¾—çš„ $prod$ å­˜æ”¾çš„å°±æ˜¯è¿™æ ·çš„ä¹˜ç§¯ï¼Œè¿™ä¸ªä¹˜ç§¯ä¹Ÿå°±æ˜¯ç­”æ¡ˆã€‚
eg:
æˆ‘ä»¬è¦åˆ¤æ–­ä¸€ä¸ªæ•° $N$ çš„çº¦æ•°ä¹‹å’Œæ˜¯å¦æ˜¯æˆ‘ä»¬éœ€è¦çš„.
ç”± $N = P_1^{\alpha_1}\times P_2^{\alpha_2}\times\dots\times P_k^{\alpha_k}$
å¯ä»¥å¾—åˆ°ï¼š$12 = 2^2\times 3^1$
ç”± $sum = (P_1^0 + P_1^1 +\dots + P_1^{\alpha_1})\times(P_2^0 + P_2^1 +\dots + P_2^{\alpha_2})\times\dots(P_k^0 + P_k^1+\dots + P_k^{\alpha_k})$
å¯ä»¥å¾—åˆ°ï¼š$sum = (1 + 2 + 2^2)\times(1 + 3)$
æ‰€ä»¥å¯ä»¥æ ¹æ® $sum$ ä¸­æ¯ä¸€é¡¹çš„æœ€é«˜æ¬¡é¡¹çš„ä¹˜ç§¯å¾—åˆ°ç­”æ¡ˆ N</li>
<li><code>s</code>
å½“ $s == 1$ çš„æ—¶å€™ï¼Œè¡¨ç¤ºå·²ç»æœå®Œäº†æœ€åä¸€ä¸ªé¡¹ï¼Œä¿å­˜ç­”æ¡ˆåè¿”å›ã€‚
ç‰¹åˆ¤ $P_i &gt;= \sqrt s $ çš„æƒ…å†µï¼Œå¦‚æœ $s - 1 = P_i$ é‚£ä¹ˆä¿å­˜ç­”æ¡ˆ
å‰©ä¸‹çš„å°±æ˜¯ $P_i &lt; \sqrt s $ çš„ä¸€èˆ¬æƒ…å†µï¼Œæ¯æ¬¡æ‰¾åˆ°å¯ä»¥æ•´é™¤çš„é¡¹å°±é€’å½’åˆ°ä¸‹ä¸€å±‚ï¼Œæ­¤æ—¶ $s$ æ›´æ–°ä¸ºæ•´é™¤åçš„å€¼</li>
</ol>
</li>
</ol>
<h3 id="code">Code</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">50000</span><span class="p">;</span> <span class="c1">// N = sqrt(2e9)
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="kt">int</span> <span class="n">ans</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">len</span><span class="p">;</span> <span class="c1">// ä¿å­˜ç­”æ¡ˆå’Œç­”æ¡ˆä¸ªæ•°
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="kt">void</span> <span class="nf">get_primes</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="c1">// çº¿æ€§ç­›è´¨æ•°
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">primes</span><span class="p">[</span><span class="n">cnt</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="kt">bool</span> <span class="nf">is_prime</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="c1">// åˆ¤æ–­æ˜¯å¦æ˜¯è´¨æ•°
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">)</span> <span class="k">return</span> <span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">n</span><span class="p">];</span> <span class="c1">// å¦‚æœæ²¡æœ‰æ²¡ç­›æ‰ï¼Œè¯´æ˜æ˜¯è´¨æ•°
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">/</span><span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="c1">// last è¡¨ç¤ºå½“å‰è¦ä»å“ªä¸ªè´¨æ•°çš„ä¸‹æ ‡å¼€å§‹æšä¸¾ï¼Œprod è¡¨ç¤ºè¦æ‰¾çš„ç­”æ¡ˆçš„éƒ¨åˆ†è´¨æ•°ä¹˜ç§¯ï¼Œs è¡¨ç¤ºå½“å‰è¦åˆ†è§£çº¦æ•°å’Œ
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">last</span><span class="p">,</span> <span class="kt">int</span> <span class="n">prod</span><span class="p">,</span> <span class="kt">int</span> <span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">// å¦‚æœåˆ†è§£åˆ°æœ€ååªå‰©ä¸‹ä¸€ä¸ª 1ï¼Œé‚£ä¹ˆåˆ†è§£ç»“æŸï¼Œè¿”å›
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="n">ans</span><span class="p">[</span><span class="n">len</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">prod</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">
</span></span><span class="line"><span class="ln">43</span><span class="cl">    <span class="c1">// é¦–å…ˆç‰¹åˆ¤ä¸€ä¸‹ P1 &gt;= sqrt(s), s - 1 = P1 çš„æƒ…å†µ,ç­‰ä»·äºåˆ¤æ–­ s - 1 æ˜¯ä¸æ˜¯è´¨æ•°ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œé‚£ä¹ˆ s - 1 å°±æ˜¯ä¸€ç§ç­”æ¡ˆ
</span></span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">last</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">primes</span><span class="p">[</span><span class="n">last</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">// ä¸ä»…è¦æ˜¯è´¨æ•°ï¼Œè¿˜è¦æ˜¯å¤§äºä¸Šä¸€å±‚è´¨æ•°çš„è´¨æ•°
</span></span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="c1"></span>        <span class="n">ans</span><span class="p">[</span><span class="n">len</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">prod</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">
</span></span><span class="line"><span class="ln">47</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">last</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">s</span><span class="o">/</span><span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="c1">// ä»ä¸‹ä¸€ä¸ªè´¨æ•°å¼€å§‹æšä¸¾
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">        <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">p</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">s</span><span class="p">;</span> <span class="n">t</span><span class="o">*=</span><span class="n">p</span><span class="p">,</span><span class="n">j</span><span class="o">+=</span><span class="n">t</span><span class="p">)</span> <span class="c1">//  // j == 1 + Pi^1 + Pi^2 + ... + Pi^Î±i
</span></span></span><span class="line"><span class="ln">51</span><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">s</span> <span class="o">%</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">prod</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span> <span class="o">/</span> <span class="n">j</span><span class="p">);</span> <span class="c1">// å½“ j æ˜¯ s çš„æŸä¸€é¡¹çš„æ—¶å€™ï¼Œé€’å½’åˆ°ä¸‹ä¸€å±‚
</span></span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">
</span></span><span class="line"><span class="ln">57</span><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">59</span><span class="cl">    <span class="n">get_primes</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">60</span><span class="cl">
</span></span><span class="line"><span class="ln">61</span><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">62</span><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">63</span><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="ln">64</span><span class="cl">        <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">65</span><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">66</span><span class="cl">
</span></span><span class="line"><span class="ln">67</span><span class="cl">        <span class="c1">// æœç´¢å®Œä¹‹åï¼ŒæŠŠç­”æ¡ˆæ’åº
</span></span></span><span class="line"><span class="ln">68</span><span class="cl"><span class="c1"></span>        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">len</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">69</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">70</span><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="ln">71</span><span class="cl">            <span class="n">sort</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">ans</span> <span class="o">+</span> <span class="n">len</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">72</span><span class="cl">            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">73</span><span class="cl">            <span class="n">puts</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">74</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">75</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">76</span><span class="cl">
</span></span><span class="line"><span class="ln">77</span><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">78</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></div>
  </div>
</article>


  
    <div class="pagination__title">
    <span class="pagination__title-h" style="font-size: 20px;">ğŸ’¬Discussion</span>
    <hr />
</div>
<script src="//cdn.jsdelivr.net/npm/twikoo@1.6.21/dist/twikoo.all.min.js"></script>
<div id="tcomment"></div><script>
    twikoo.init({
        envId: "https:\/\/twikoo.coldcoding.top\/",  
        el: "#tcomment", 
        
        
    });
</script>




    </div>
    <footer class="footer">
  <hr />
  <span>
    Copyright 2022-2024<a href="https://icp.gov.moe/?keyword=20241230" target="_blank">èŒICPå¤‡20241230å·</a>&nbsp;Powered by <a>æ„›</a> 
  </span>
  <span>
    All articles on this site are licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a >
  </span>
</footer>

<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
  <span class="topInner">
      <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
          <path d="M12 6H0l6-6z"/>
      </svg>
      <span id="read_progress"></span>
  </span>
</a>

<script>
  var backButton = document.getElementById("top-link");
  var lastScrollPosition = window.pageYOffset;

  function showBackButton() {
      backButton.style.visibility = "visible";
      backButton.style.opacity = '1';
  }
  function halfHideBackButton() {
      backButton.style.visibility = "visible";
      backButton.style.opacity = '0.3';
  }
  function hideBackButton() {
      backButton.style.visibility = "hidden";
      backButton.style.opacity = '0';
  }

  window.onscroll = function () {
      var currentScrollPosition = window.pageYOffset;
      if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
        showBackButton()
        if (Math.abs(currentScrollPosition - lastScrollPosition) < 10) {
          halfHideBackButton()
        }
      } else {
        hideBackButton()
      }
      lastScrollPosition = currentScrollPosition;
  };
</script>
<script>
  document.querySelectorAll('pre > code').forEach((codeblock) => {
      const container = codeblock.parentNode.parentNode;
      const copybutton = document.createElement('button');
      copybutton.classList.add('copy-code');
      copybutton.innerText = 'copy';
      console.log(copybutton)

      function copyingDone() {
          copybutton.innerText = 'copied!';
          setTimeout(() => {
              copybutton.innerText = 'copy';
          }, 2000);
      }

      copybutton.addEventListener('click', (cb) => {
          if ('clipboard' in navigator) {
              let text = codeblock.textContent;
              navigator.clipboard.writeText(text);
              copyingDone();
              return;
          }

          const range = document.createRange();
          range.selectNodeContents(codeblock);
          const selection = window.getSelection();
          selection.removeAllRanges();
          selection.addRange(range);
          try {
              document.execCommand('copy');
              copyingDone();
          } catch (e) {}
          selection.removeRange(range);
      });

      let language = codeblock.className.replaceAll("language-", "")
      let macTool = document.createElement("div")
      let macTool1 = document.createElement("div")
      let macTool2 = document.createElement("div")
      let macTool3 = document.createElement("div")
      let languageType = document.createElement("div")
      languageType.innerText = language
      macTool.setAttribute('class', 'mac-tool')
      macTool1.setAttribute('class', 'mac bb1')
      macTool2.setAttribute('class', 'mac bb2')
      macTool3.setAttribute('class', 'mac bb3')
      languageType.setAttribute('class', 'language-type')
      macTool.appendChild(macTool1)
      macTool.appendChild(macTool2)
      macTool.appendChild(macTool3)
      macTool.appendChild(languageType)

      if (container.classList.contains("highlight")) {
          container.appendChild(copybutton);
          container.appendChild(macTool)
      } else if (container.parentNode.firstChild == container) {
          
      } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
          
          codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
          container.appendChild(macTool)
      } else {
          
          codeblock.parentNode.appendChild(copybutton);
          container.appendChild(macTool)
      }
  });
</script></body>
</html>
